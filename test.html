<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Hora e Temperatura</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 50px;
            background: #1a1a1a;
            color: white;
        }
        .test-box {
            background: #2a2a2a;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .success { color: #4CAF50; }
        .error { color: #f44336; }
        h2 { margin-top: 0; }
    </style>
</head>
<body>
    <h1>üß™ Teste de Funcionalidades</h1>
    
    <div class="test-box">
        <h2>‚è∞ Hora e Data</h2>
        <p>Hora: <strong id="time">--:--</strong></p>
        <p>Data: <strong id="date">Carregando...</strong></p>
        <p id="time-status"></p>
    </div>
    
    <div class="test-box">
        <h2>üå§Ô∏è Meteorologia (Rio Caldo)</h2>
        <p>Temperatura: <strong id="temperature">--¬∞</strong></p>
        <p>Condi√ß√µes: <strong id="weather-desc">Carregando...</strong></p>
        <p>√çcone: <span id="weather-icon" style="font-size: 2em;">‚óé</span></p>
        <p id="weather-status"></p>
    </div>

    <div class="test-box">
        <h2>üìã Console Log</h2>
        <pre id="console-log" style="background: #1a1a1a; padding: 15px; border-radius: 5px; max-height: 300px; overflow-y: auto;"></pre>
    </div>

    <script>
        // Capture console logs
        const originalLog = console.log;
        const originalError = console.error;
        const logElement = document.getElementById('console-log');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logElement.textContent += '[LOG] ' + args.join(' ') + '\n';
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            logElement.textContent += '[ERROR] ' + args.join(' ') + '\n';
        };

        document.addEventListener('DOMContentLoaded', function() {
            console.log('‚úÖ P√°gina carregada - DOM ready');
            
            // Test time update
            function updateTime() {
                try {
                    const now = new Date();
                    const timeString = now.toLocaleTimeString('pt-PT', { 
                        hour: '2-digit', 
                        minute: '2-digit',
                        second: '2-digit'
                    });
                    const dateString = now.toLocaleDateString('pt-PT', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                    
                    document.getElementById('time').textContent = timeString;
                    document.getElementById('date').textContent = dateString;
                    document.getElementById('time-status').innerHTML = '<span class="success">‚úÖ Hora a funcionar!</span>';
                    console.log('‚è∞ Hora atualizada:', timeString);
                } catch (error) {
                    document.getElementById('time-status').innerHTML = '<span class="error">‚ùå Erro: ' + error.message + '</span>';
                    console.error('Erro na hora:', error);
                }
            }

            updateTime();
            setInterval(updateTime, 1000);

            // Test weather
            async function updateWeather() {
                try {
                    console.log('üåê A buscar meteorologia...');
                    const response = await fetch(
                        'https://api.open-meteo.com/v1/forecast?latitude=41.7333&longitude=-8.1667&current=temperature_2m,weather_code&timezone=Europe/Lisbon'
                    );
                    
                    if (!response.ok) {
                        throw new Error('API retornou: ' + response.status);
                    }
                    
                    const data = await response.json();
                    console.log('üì¶ Dados recebidos:', JSON.stringify(data.current));
                    
                    const temp = Math.round(data.current.temperature_2m);
                    const weatherCode = data.current.weather_code;
                    
                    const weatherDescriptions = {
                        0: 'C√©u limpo', 1: 'Maioritariamente limpo', 2: 'Parcialmente nublado', 
                        3: 'Nublado', 45: 'Nevoeiro', 48: 'Nevoeiro com geada',
                        61: 'Chuva fraca', 63: 'Chuva moderada', 65: 'Chuva forte'
                    };
                    
                    let icon = '‚óé';
                    if (weatherCode === 0) icon = '‚òÄ';
                    else if (weatherCode <= 3) icon = '‚õÖ';
                    else if (weatherCode <= 48) icon = 'üå´';
                    else if (weatherCode <= 65) icon = 'üåß';
                    
                    document.getElementById('temperature').textContent = temp + '¬∞';
                    document.getElementById('weather-desc').textContent = weatherDescriptions[weatherCode] || 'Rio Caldo';
                    document.getElementById('weather-icon').textContent = icon;
                    document.getElementById('weather-status').innerHTML = '<span class="success">‚úÖ Meteorologia a funcionar!</span>';
                    
                    console.log('‚úÖ Meteorologia atualizada: ' + temp + '¬∞ - ' + weatherDescriptions[weatherCode]);
                } catch (error) {
                    document.getElementById('weather-status').innerHTML = '<span class="error">‚ùå Erro: ' + error.message + '</span>';
                    console.error('‚ùå Erro na meteorologia:', error);
                }
            }

            updateWeather();
        });
    </script>
</body>
</html>
